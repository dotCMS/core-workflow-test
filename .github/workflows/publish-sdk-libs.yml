name: 'Publish SDK libs'
on:
  push:
    branches: [ master ]

env:
  BRANCH: ${{ inputs.branch || github.ref_name }}
  NODE_VERSION: '18'
  
jobs:
  publish-sdk-on-npm:
    runs-on: ubuntu-20.04
    environment: trunk
    steps:
      - name: 'Checkout'
        uses: actions/checkout@v4
        with:
          ref: ${{ env.BRANCH }}
          
      - name: 'Set up Node.js'
        uses: actions/setup-node@v4
        with:
          node-version: ${{ env.NODE_VERSION }}
          
      - uses: ./.github/actions/publish-npm-sdks
        with:
          ref: ${{ env.BRANCH }}
          node-version: ${{ env.NODE_VERSION }}
          npm-token: ${{ secrets.NPM_ORG_TOKEN }}
          github-token: ${{ secrets.GITHUB_TOKEN }}
